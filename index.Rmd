---
title: "Decoding KPOP vs. KRnB"
output:
    flexdashboard::flex_dashboard:
      storyboard: true
      theme: flatly
author: Ananta Wibisono
      
date: "2024-02-14"
---

```{r asdfsadf, echo=FALSE}
library(spotifyr)
krnb <- get_playlist_audio_features("", "37i9dQZF1EIecOSIx69OSk")
kpop <- get_playlist_audio_features("", "37i9dQZF1EQpesGsmIyqcW")
krnb_general <- get_playlist_audio_features("", "2TJHOlrTUoLMHs9CTyxN9n")
krnb_general_50 <- head(krnb_general, 50)
kpop_general <- get_playlist_audio_features("", "37i9dQZF1DX9tPFwDMOaN1")

kpop_general_sorted <- kpop_general[order(kpop_general$energy), ]

# Remove the 5 lowest energy tracks
kpop_general_49 <- kpop_general_sorted[-(1:5), ]



warr <- get_track_audio_features(c("1ZEFYW6nPEvIcsIvymgsLk", "3DBKc4ioGnMQLlbGQcFDIO"))

library(ggplot2)
library(plotly)
library(dplyr)
library(tibble)
library(compmus)
library(tidyr)
library(purrr)
```

Self similarity matrices
========================================

Column {data-width=750}
-------------------------------------

### Self similarity matrix

```{r self plot, echo=FALSE}
bzt <-
  get_tidy_audio_analysis("1ZEFYW6nPEvIcsIvymgsLk") |> # Change URI.
  compmus_align(bars, segments) |>                     # Change `bars`
  select(bars) |>                                      #   in all three
  unnest(bars) |>                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) |>
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )
```

```{r self plot2, echo=FALSE}
  bzt |>
  compmus_self_similarity(timbre, "cosine") |> 
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_fixed() +
  scale_fill_viridis_c(guide = "none") +
  theme_classic() +
  labs(x = "", y = "") + labs(title = "WA-R-R - Colde")
```

Column {data-width=250}
-------------------------------------
**Description**

no description yet 

this is my fav song tho btw

Chroma and Timbre plots
========================================

Column {.tabset}
-------------------------------------

### Lowest Energy Song Chromagram

```{r chromagram, echo=FALSE}


wood1 <-
  get_tidy_audio_analysis("6TBJkXHPhu3EsMk1bshwuI") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)

wood1 |>
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) |>
  compmus_gather_chroma() |> 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  theme_minimal() +
  scale_fill_viridis_c() +
  labs(title = "ONLY - Leehi")
```

### Highest Energy Song Chromagram

```{r chromagram2, echo=FALSE}
library(tidyr)
library(purrr)

wood2 <-
  get_tidy_audio_analysis("0CnpSTdL9l5vQM4YnzXtyo") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)

wood2 |>
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) |>
  compmus_gather_chroma() |> 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  theme_minimal() +
  scale_fill_viridis_c() + labs(title = "Panorama - IZ*ONE")
```



Column {data-width=250}
-------------------------------------

**Description**

no description yet

Overview
========================================

Column {data-width=500}
-------------------------------------

### Corpus Description

**Introduction**

I've put together a collection of playlists that represent my taste in music, particularly focusing on KRnB and KPOP genres. These playlists consist of four categories: two are tailored to my personal preferences in KRnB and KPOP, while the other two feature more general KRnB and KPOP tracks. The selection of these playlists is based on my deep love for KRnB and KPOP music.

The personal playlists are curated by Spotify, using my listening history to tailor the content to my tastes. On the other hand, the broader KRnB and KPOP playlists are popular among a wider audience.

With this collection, I aim to analyze and understand the differences between KRnB and KPOP. I'm also interested in exploring why I prefer certain KPOP and KRnB tracks over others. This analysis will help me gain insights into my music preferences and the unique characteristics of these genres.



Column {data-width=500}
-------------------------------------

![]("C:\Users\anant\Downloads\overview.png")


Corpus Analysis
========================================



Column {.tabset}
-------------------------------------

### Energy Distribution

```{r difference in tempo, echo=FALSE}
# Calculate mean values
krnb_mean <- mean(krnb$energy)
kpop_mean <- mean(kpop$energy)
gen_krnb_mean <- mean(krnb_general_50$energy)
gen_kpop_mean <- mean(kpop_general_49$energy)

# Plot with mean lines
histies <- ggplot() +
  geom_histogram(data = krnb, aes(x = energy, fill = "Personal Korean R&B Mix"), alpha = 0.5) +
  geom_histogram(data = kpop, aes(x = energy, fill = "Personal K-POP Mix"), alpha = 0.5) +
  geom_histogram(data = krnb_general_50, aes(x = energy, fill = "General Korean R&B"), alpha = 0.5) +
  geom_histogram(data = kpop_general_49, aes(x = energy, fill = "General K-POP"), alpha = 0.5) +
  geom_vline(xintercept = krnb_mean, color = "green", linetype = "twodash", size = 0.5) + 
  geom_vline(xintercept = kpop_mean, color = "red", linetype = "twodash", size = 0.5) +    
  geom_vline(xintercept = gen_krnb_mean, color = "blue", linetype = "twodash", size = 0.5) + 
  geom_vline(xintercept = gen_kpop_mean, color = "yellow", linetype = "twodash", size = 0.5) +  
  scale_fill_manual(name = "Genre", values = c("Personal Korean R&B Mix" = "green", "Personal K-POP Mix" = "red", "General Korean R&B" = "blue", "General K-POP" = "yellow" )) +
  theme(legend.position = "right") + labs(title = "Energy Difference between Krnb and Kpop") + theme_classic() 

histies <- ggplotly(histies)

histies
```

### Acousticness Comparison

```{r timbre plot, echo=FALSE}
library(Hmisc)

# Add a column to each dataframe to specify the genre for labeling on the plot
krnb$genre <- "krnb"
kpop$genre <- "kpop"
krnb_general_50$genre <- "krnb"
kpop_general$genre <- "kpop"

# Combine the dataframes
combined_data <- rbind(krnb, kpop, krnb_general_50, kpop_general)

# Create a boxplot for acousticness
boxplot_acousticness <- ggplot(combined_data, aes(x = genre, y = acousticness, fill = genre)) +
  geom_boxplot() +
  labs(title = "Comparison of Acousticness between krnb and kpop", x = "Genre", y = "Acousticness") +
  scale_fill_manual(values = c("krnb" = "purple", "kpop" = "green")) +
  theme_minimal()


boxplot_acousticness <- ggplotly(boxplot_acousticness)

boxplot_acousticness
```

Column {data-width=250}
-------------------------------------

**Energy Distribution**

In this plot I pulled in data of 4 different playlists: 

1. My Personal KrnB playlist
2. My Personal Kpop playlist
3. A popular KRnB playlist
4. A popular KPOP playlist

Let's first look at the personal playlists by selecting that option in the plot legend.

What we see is that, on average, KPOP songs tend to have higher energy levels compared to KRnB. But there's a catch â€“ there's some overlap between the two genres. This means that a KRnB track could have the energy level typical of a KPOP song, and vice versa. It goes to show that energy level is just one factor among many that define a song's genre.

Now, when we switch over to the general playlists, things look different. The songs seem more spread out across energy levels compared to the personal playlists. This suggests that personally, I might have a specific energy level in mind when picking KRnB or KPOP songs for my playlists. It's all about personal taste and what vibes with me the most.

**Acousticness Comparison**


Looking at the plot, it's clear that KRnB songs tend to have higher acousticness compared to KPOP tunes. There's just a small sliver of overlap between the acousticness of KRnB and KPOP tracks. Also, notice how the range of acousticness for KRnB songs is wider than that of KPOP. This suggests that KRnB artists have more leeway in using different instruments compared to the more structured sound of KPOP.



Relation between loudness and energy
========================================


Column {.tabset}
-------------------------------------

### Acousticness Comparison

```{r energy plot, echo=FALSE}
corr_plot <- ggplot() +
  geom_point(data = krnb, aes(energy, loudness, color = "krnb", size = valence, text = track.name), alpha = 0.7) +
  geom_point(data = kpop, aes(energy, loudness, color = "kpop", size = valence, text = track.name), alpha = 0.7) +
  # Calculate and add a linear regression line through all points
  geom_smooth(data = rbind(krnb, kpop), aes(energy, loudness), method = "lm", se = FALSE, color = "red", alpha = 0.4) +
  scale_color_manual(values = c("krnb" = "blue", "kpop" = "green"),
                     labels = c("kpop", "krnb"),
                     name = "Genres") + 
  labs(title = "Energy vs Loudness with Valence as size")

corr_plot <- ggplotly(corr_plot, tooltip = c("text"))

corr_plot
```




Column {data-width=250}
-------------------------------------



**Description**

In the plot, you can clearly see how energy and loudness are linked, especially with that regression line slicing through the data points. There's also this faint boundary line that seems to separate KPOP and KRnB songs. Oh, and there's this one standout: the KPOP hit "Cupid" by Fifty Fifty, chilling in the KRnB zone for loudness and energy. Just hover over the point to check it out!


