---
title: "Computational Musicology Project"
output:
    flexdashboard::flex_dashboard:
      storyboard: true
      theme: flatly
author: Ananta Wibisono
      
date: "2024-02-14"
---

```{r asdfsadf, echo=FALSE}
library(spotifyr)
krnb <- get_playlist_audio_features("", "37i9dQZF1EIecOSIx69OSk")
kpop <- get_playlist_audio_features("", "37i9dQZF1EQpesGsmIyqcW")
krnb_general <- get_playlist_audio_features("", "2TJHOlrTUoLMHs9CTyxN9n")
krnb_general_50 <- head(krnb_general, 50)
kpop_general <- get_playlist_audio_features("", "37i9dQZF1DX9tPFwDMOaN1")

kpop_general_sorted <- kpop_general[order(kpop_general$energy), ]

# Remove the 5 lowest energy tracks
kpop_general_49 <- kpop_general_sorted[-(1:5), ]



warr <- get_track_audio_features(c("1ZEFYW6nPEvIcsIvymgsLk", "3DBKc4ioGnMQLlbGQcFDIO"))

library(ggplot2)
library(plotly)
library(dplyr)
library(tibble)
```
Overview
========================================

Column {data-width=500}
-------------------------------------

### Corpus Description

I have constructed a corpus comprising four playlists: two tailored to my personal taste in KRnB and KPOP, and another two featuring general KRnB and KPOP tracks. The selection of these playlists stems from my deep appreciation for KRnB and KPOP music genres. The personal playlists are curated by Spotify, leveraging my listening history, while the broader KRnB and KPOP playlists are popular among a wide audience.

Through this corpus, my aim is to conduct an analysis elucidating the distinctions between KRnB and KPOP. Additionally, I seek to understand the underlying reasons behind my preference for certain KPOP and KRnB tracks over others.

Column {data-width=500}
-------------------------------------

![]("C:\Users\anant\Downloads\overview.png")


Difference in Tempo
========================================



Column {data-width=750}
-------------------------------------

### Plot: Difference in Tempo

```{r difference in tempo, echo=FALSE}
# Calculate mean values
krnb_mean <- mean(krnb$energy)
kpop_mean <- mean(kpop$energy)
gen_krnb_mean <- mean(krnb_general_50$energy)
gen_kpop_mean <- mean(kpop_general_49$energy)

# Plot with mean lines
histies <- ggplot() +
  geom_histogram(data = krnb, aes(x = energy, fill = "Personal Korean R&B Mix"), alpha = 0.5) +
  geom_histogram(data = kpop, aes(x = energy, fill = "Personal K-POP Mix"), alpha = 0.5) +
  geom_histogram(data = krnb_general_50, aes(x = energy, fill = "General Korean R&B"), alpha = 0.5) +
  geom_histogram(data = kpop_general_49, aes(x = energy, fill = "General K-POP"), alpha = 0.5) +
  geom_vline(xintercept = krnb_mean, color = "green", linetype = "twodash", size = 0.5) + 
  geom_vline(xintercept = kpop_mean, color = "red", linetype = "twodash", size = 0.5) +    
  geom_vline(xintercept = gen_krnb_mean, color = "blue", linetype = "twodash", size = 0.5) + 
  geom_vline(xintercept = gen_kpop_mean, color = "yellow", linetype = "twodash", size = 0.5) +  
  scale_fill_manual(name = "Genre", values = c("Personal Korean R&B Mix" = "green", "Personal K-POP Mix" = "red", "General Korean R&B" = "blue", "General K-POP" = "yellow" )) +
  theme(legend.position = "right") + labs(title = "Energy Difference between Krnb and Kpop") + theme_classic() 

histies <- ggplotly(histies)

histies
```

Column {data-width=250}
-------------------------------------

**Summary**

In this plot I pulled in data of 4 different playlists: 

1. My Personal KrnB playlist
2. My Personal Kpop playlist
3. A curated KRnB playlist
4. A curated KPOP playlist

Lets only view the personal playlists for now by clicking on the legend of the interactive plot. 

For these playlists I hypothesized that the KPOP playlist would have a higher mean energy level than the krnb playlist. This hypothesis turned out to be true when looking at the histogram plot. Besides the mean energy level indeed being higher for KPOP songs, you can also see a slight overlap with some krnb and kpop songs having the same energy levels. An interesting finding is that there are some krnb songs that fall in the upper spectrum of the energy level of even the KPOP song category: 

```{r show high energy level songs, echo=FALSE}
krnb_show <- krnb[order(krnb$energy, decreasing = TRUE), c("energy", "track.name")]

krnb_show %>%
  slice_head(n = 2) %>%
  knitr::kable()

```

Relation between loudness and energy
========================================

Column {.tabset}
-------------------------------------

### Plot: Relation between loudness and energy

```{r energy plot, echo=FALSE}
corr_plot <- ggplot() +
  geom_point(data = krnb, aes(energy, loudness, color = "krnb", size = valence, text = track.name), alpha = 0.7) +
  geom_point(data = kpop, aes(energy, loudness, color = "kpop", size = valence, text = track.name), alpha = 0.7) +
  # Calculate and add a linear regression line through all points
  geom_smooth(data = rbind(krnb, kpop), aes(energy, loudness), method = "lm", se = FALSE, color = "red", alpha = 0.4) +
  scale_color_manual(values = c("krnb" = "blue", "kpop" = "green"),
                     labels = c("kpop", "krnb"),
                     name = "Genres") + 
  labs(title = "Energy vs Loudness with Valence as size")

corr_plot <- ggplotly(corr_plot, tooltip = c("text"))

corr_plot
```

### Timbre plot

```{r timbre plot, echo=FALSE}
library(Hmisc)

# Add a column to each dataframe to specify the genre for labeling on the plot
krnb$genre <- "krnb"
kpop$genre <- "kpop"

# Combine the dataframes
combined_data <- rbind(krnb, kpop)

# Create a boxplot for acousticness
boxplot_acousticness <- ggplot(combined_data, aes(x = genre, y = acousticness, fill = genre)) +
  geom_boxplot() +
  labs(title = "Comparison of Acousticness between krnb and kpop", x = "Genre", y = "Acousticness") +
  scale_fill_manual(values = c("krnb" = "purple", "kpop" = "green")) +
  theme_minimal()


boxplot_acousticness <- ggplotly(boxplot_acousticness)

boxplot_acousticness
```


Column {data-width=250}
-------------------------------------



**Summary**

In this plot i hyposthesised that energy and loudness had a correlation and it was shown to be indeed the case, this is even more shown by the regression line that is ran through the data points. You can also see a slight boundry line being present between kpop an krnb songs. Besides that there is again 1 outlier but in this case i want to highlight the 1 kpop song that falls in the krnb category in terms of loudness


